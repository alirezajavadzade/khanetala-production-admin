import{a4 as de,_ as ce,r as s,i as pe,c as fe,b as n,w as u,$ as E,e as Ve,a5 as ye,a3 as be,o as P,a0 as c,A as $,a as t,t as r,V as T,a2 as I,a1 as ge}from"./index-wToI4KX1.js";import{V as Y}from"./api-NHTAw_A2.js";import{V as F}from"./VDialog-Cf1xPgS6.js";import{V as xe,a as G,b as we,c as H}from"./VTabs-8wd_90-Z.js";import{b as ke,V as C,a as N,c as q}from"./VTextField-B4XjEIel.js";import{V as J,a as A}from"./VDataTable-gfjExOxn.js";import{V as K}from"./VSpacer-F339Tu_n.js";import{V as Ce}from"./VForm-DXoTNQTe.js";import"./VMenu-CWJpJzYw.js";import"./index-DqRtrUNQ.js";import"./VImg-DHToRddC.js";const z=de.create({baseURL:"https://khaneetala.ir/api",headers:{"Content-Type":"application/json",Accept:"application/json"}});z.interceptors.request.use(o=>{const v=localStorage.getItem("token");return v&&(o.headers.Authorization=`Bearer ${v}`),o},o=>Promise.reject(o));z.interceptors.response.use(o=>o,o=>(o.response.status==401&&(localStorage.removeItem("token"),router.push("/login")),console.error("API Error:",o.response||o.message),Promise.reject(o)));const B={async Alluser(){return(await z.get("/admin/users/all")).data},async oldUser(){return(await Y.get("/old/users")).data},async VerifyUser(o){const v=JSON.stringify({phoneNumber:o.phoneNumber,nationalCode:o.nationalCode,birthDate:o.birthDate});return(await Y.post(`old/approve/${o.id}`,v)).data}},Ne={class:"d-flex flex-column flex-md-row justify-space-between w-100 px-4 py-8 user-dialog-info"},_e={class:"d-flex flex-column w-100 px-4"},Ue={class:"d-flex align-items-center my-2"},he={class:"mx-2"},De={class:"d-flex align-items-center my-2"},Se={class:"mx-2"},$e={class:"d-flex align-items-center my-2"},Te={class:"mx-2"},Ie={class:"d-flex align-items-center my-2 user-price"},Ae={class:"mx-2"},Be={class:"d-flex flex-column w-100 px-4"},ze={class:"d-flex align-items-center my-2"},Me={class:"mx-2"},We={class:"d-flex align-items-center my-2"},je={class:"mx-2"},Oe={class:"d-flex align-items-center my-2"},Le={class:"mx-2"},Re={class:"d-flex align-items-center my-2 user-price"},Ee={class:"mx-2"},Pe={__name:"userView",setup(o){const v=s(!1),b=s(!1),_=s(""),U=s(""),g=s(null),x=s(""),d=s(!1),M=s(),W=s(),w=s(!1),p=s(!1),h=s(!1),Q=s([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"دارایی طلا (گرم)",key:"wallet.goldWeight"},{title:"دارایی ریالی",key:"wallet.balance"},{title:"شهر",key:"officeName"},{title:"فعالیت",key:"action"}]),X=s([{title:"نام",key:"firstName"},{title:"نام خانوادگی",key:"lastName"},{title:"شماره همراه",key:"phoneNumber"},{title:"دارایی طلا (گرم)",key:"wallet.goldWeight"},{title:"دارایی ریالی",key:"wallet.balance"},{title:"فعالیت",key:"action"}]),m=s({phoneNumber:"",nationalCode:"",birthDate:"",id:""}),i=s(),f=s(),V=s(),y=s(),Z=s([{name:"1",value:1},{name:"2",value:2},{name:"3",value:3},{name:"4",value:4},{name:"5",value:5},{name:"6",value:6},{name:"7",value:7},{name:"8",value:8},{name:"9",value:9},{name:"10",value:10},{name:"11",value:11},{name:"12",value:12},{name:"13",value:13},{name:"14",value:14},{name:"15",value:15},{name:"16",value:16},{name:"17",value:17},{name:"18",value:18},{name:"19",value:19},{name:"20",value:20},{name:"21",value:21},{name:"22",value:22},{name:"23",value:23},{name:"24",value:24},{name:"25",value:25},{name:"26",value:26},{name:"27",value:27},{name:"28",value:28},{name:"29",value:29},{name:"30",value:30},{name:"31",value:31}]),ee=s([{name:"فروردین",value:1},{name:"اردیبهشت",value:2},{name:"خرداد",value:3},{name:"تیر",value:4},{name:"مرداد",value:5},{name:"شهریور",value:6},{name:"مهر",value:7},{name:"آبان",value:8},{name:"آذر",value:9},{name:"دی",value:10},{name:"بهمن",value:11},{name:"اسفند",value:12}]),ae=s([{name:"1300",value:1300},{name:"1301",value:1301},{name:"1302",value:1302},{name:"1303",value:1303},{name:"1304",value:1304},{name:"1305",value:1305},{name:"1306",value:1306},{name:"1307",value:1307},{name:"1308",value:1308},{name:"1309",value:1309},{name:"1310",value:1310},{name:"1311",value:1311},{name:"1312",value:1312},{name:"1313",value:1313},{name:"1314",value:1314},{name:"1315",value:1315},{name:"1316",value:1316},{name:"1317",value:1317},{name:"1318",value:1318},{name:"1319",value:1319},{name:"1320",value:1320},{name:"1321",value:1321},{name:"1322",value:1322},{name:"1323",value:1323},{name:"1324",value:1324},{name:"1325",value:1325},{name:"1326",value:1326},{name:"1327",value:1327},{name:"1328",value:1328},{name:"1329",value:1329},{name:"1330",value:1330},{name:"1331",value:1331},{name:"1332",value:1332},{name:"1333",value:1333},{name:"1334",value:1334},{name:"1335",value:1335},{name:"1336",value:1336},{name:"1337",value:1337},{name:"1338",value:1338},{name:"1339",value:1339},{name:"1340",value:1340},{name:"1341",value:1341},{name:"1342",value:1342},{name:"1343",value:1343},{name:"1344",value:1344},{name:"1345",value:1345},{name:"1346",value:1346},{name:"1347",value:1347},{name:"1348",value:1348},{name:"1349",value:1349},{name:"1350",value:1350},{name:"1351",value:1351},{name:"1352",value:1352},{name:"1353",value:1353},{name:"1354",value:1354},{name:"1355",value:1355},{name:"1356",value:1356},{name:"1357",value:1357},{name:"1358",value:1358},{name:"1359",value:1359},{name:"1360",value:1360},{name:"1361",value:1361},{name:"1362",value:1362},{name:"1363",value:1363},{name:"1364",value:1364},{name:"1365",value:1365},{name:"1366",value:1366},{name:"1367",value:1367},{name:"1368",value:1368},{name:"1369",value:1369},{name:"1370",value:1370},{name:"1371",value:1371},{name:"1372",value:1372},{name:"1373",value:1373},{name:"1374",value:1374},{name:"1375",value:1375},{name:"1376",value:1376},{name:"1377",value:1377},{name:"1378",value:1378},{name:"1379",value:1379},{name:"1380",value:1380},{name:"1381",value:1381},{name:"1382",value:1382},{name:"1383",value:1383},{name:"1384",value:1384},{name:"1385",value:1385},{name:"1386",value:1386},{name:"1387",value:1387},{name:"1388",value:1388},{name:"1389",value:1389},{name:"1390",value:1390},{name:"1391",value:1391},{name:"1392",value:1392},{name:"1393",value:1393},{name:"1394",value:1394},{name:"1395",value:1395},{name:"1396",value:1396},{name:"1397",value:1397},{name:"1398",value:1398},{name:"1399",value:1399},{name:"1400",value:1400},{name:"1401",value:1401},{name:"1402",value:1402},{name:"1403",value:1403}]),j=async()=>{try{v.value=!0;const a=await B.Alluser();return M.value=a.data,a}catch(a){x.value=a.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{v.value=!1}},O=async()=>{try{b.value=!0;const a=await B.oldUser();return W.value=a.data,a}catch(a){x.value=a.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{b.value=!1}},D=a=>a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),L=a=>{w.value=!0,i.value=a},le=a=>{p.value=!0,m.value.id=a.id,m.value.phoneNumber=a.phoneNumber,m.value.nationalCode=a.nationalCode},ne=async()=>{try{h.value=!0;const a=await B.VerifyUser(m.value);return p.value=!1,O(),j(),a}catch(a){x.value=a.response.data.error||"خطایی رخ داده است!",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}finally{h.value=!1}},te=()=>{m.value.phoneNumber=m.value.phoneNumber.replace(/\D/g,"").slice(0,11)},ue=()=>{m.value.nationalCode=m.value.nationalCode.replace(/\D/g,"").slice(0,10),R.every(a=>a(m.value.nationalCode)===!0)},se=a=>{f.value=a,S()},oe=a=>{V.value=a,S()},me=a=>{y.value=a,S()},S=()=>{if(y.value&&V.value&&f.value){const a=String(V.value).padStart(2,"0"),e=String(f.value).padStart(2,"0");m.value.birthDate=`${y.value}${a}${e}`}},re=[a=>!!a||"شماره همراه نمی‌تواند خالی باشد",a=>/^\d{11}$/.test(a)||"شماره همراه باید 11 رقم باشد",a=>a.startsWith("09")||"شماره همراه باید با 09 شروع شود"],R=[a=>!!a||"کد ملی الزامی است",a=>/^\d{10}$/.test(a)||"کد ملی باید ۱۰ رقم باشد",a=>{if(!/^\d{10}$/.test(a))return!0;const e=+a[9],l=a.split("").slice(0,9).reduce((k,ie,ve)=>k+ +ie*(10-ve),0)%11;return l<2&&e===l||l>=2&&e+l===11||"کد ملی نامعتبر است"}];return pe(()=>{j(),O()}),(a,e)=>(P(),fe("div",null,[n(E,null,{default:u(()=>[n(c,null,{default:u(()=>[n(xe,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),"align-tabs":"center"},{default:u(()=>[n(G,{value:"one"},{default:u(()=>e[14]||(e[14]=[$("کاربران احراز شده")])),_:1}),n(G,{value:"two"},{default:u(()=>e[15]||(e[15]=[$("کاربران درانتظار احراز")])),_:1})]),_:1},8,["modelValue"])]),_:1}),n(c,{cols:"12"},{default:u(()=>[n(ke,null,{default:u(()=>[n(we,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=l=>g.value=l)},{default:u(()=>[n(H,{value:"one"},{default:u(()=>[n(C,{title:"کاربران احراز هویت شده"},{text:u(()=>[n(N,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=l=>_.value=l),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:u(()=>[n(J,{headers:Q.value,items:M.value,search:_.value,loading:v.value},{"item.wallet.balance":u(({item:l})=>[t("p",null,r(D(l.wallet.balance)),1)]),"item.action":u(({item:l})=>[n(T,{class:"me-2",size:"small",icon:"ri-information-line",color:"#d4af37",onClick:k=>L(l)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1}),n(H,{value:"two"},{default:u(()=>[n(C,{title:"کاربران در انتظار احراز"},{text:u(()=>[n(N,{modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=l=>U.value=l),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:u(()=>[n(J,{headers:X.value,items:W.value,search:U.value,loading:b.value},{"item.wallet.balance":u(({item:l})=>[t("p",null,r(D(l.wallet.balance)),1)]),"item.action":u(({item:l})=>[n(T,{class:"me-2",size:"small",icon:"ri-information-line",color:"#d4af37",onClick:k=>L(l)},null,8,["onClick"]),n(T,{class:"me-2",size:"small",icon:"ri-user-follow-line",color:"#008000",onClick:k=>le(l)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(F,{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=l=>w.value=l),"max-width":"600",class:"dialog"},{default:u(()=>[n(C,{class:"dialog-card"},{default:u(()=>[e[24]||(e[24]=t("div",{class:"k-dialog-title"},[t("p",null,"اطلاعات کاربران")],-1)),t("div",Ne,[t("div",_e,[t("div",Ue,[e[16]||(e[16]=t("p",null,"نام: ",-1)),t("p",he,r(i.value.firstName),1)]),t("div",De,[e[17]||(e[17]=t("p",null,"نام خانوادگی: ",-1)),t("p",Se,r(i.value.lastName),1)]),t("div",$e,[e[18]||(e[18]=t("p",null,"نام پدر: ",-1)),t("p",Te,r(i.value.fatherName),1)]),t("div",Ie,[e[19]||(e[19]=t("p",null,"موجودی کیف پول: ",-1)),t("p",Ae,r(D(i.value.wallet.balance))+" ریال",1)])]),t("div",Be,[t("div",ze,[e[20]||(e[20]=t("p",null,"تاریخ تولد: ",-1)),t("p",Me,r(i.value.birthDate),1)]),t("div",We,[e[21]||(e[21]=t("p",null,"کد ملی: ",-1)),t("p",je,r(i.value.nationalCode),1)]),t("div",Oe,[e[22]||(e[22]=t("p",null,"شماره همراه: ",-1)),t("p",Le,r(i.value.phoneNumber),1)]),t("div",Re,[e[23]||(e[23]=t("p",null,"موجودی طلا: ",-1)),t("p",Ee,r(i.value.wallet.goldWeight)+" گرم",1)])])]),n(q,null,{default:u(()=>[n(K),n(I,{text:"بستن",onClick:e[4]||(e[4]=l=>w.value=!1),size:"large",class:"m-3"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(F,{modelValue:p.value,"onUpdate:modelValue":e[13]||(e[13]=l=>p.value=l),"max-width":"600",class:"dialog",persistent:""},{default:u(()=>[n(Ce,{ref:"form",onSubmit:e[12]||(e[12]=ge(l=>ne(a.item),["prevent"]))},{default:u(()=>[n(C,{class:"dialog-card"},{default:u(()=>[e[25]||(e[25]=t("div",{class:"k-dialog-title"},[t("p",null,"احراز هویت")],-1)),n(E,{class:"my-5"},{default:u(()=>[n(c,{cols:"12",md:"6",class:"my-3"},{default:u(()=>[n(N,{modelValue:m.value.phoneNumber,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value.phoneNumber=l),label:"شماره همراه",rules:re,onInput:te},null,8,["modelValue"])]),_:1}),n(c,{cols:"12",md:"6",class:"my-3"},{default:u(()=>[n(N,{modelValue:m.value.nationalCode,"onUpdate:modelValue":e[7]||(e[7]=l=>m.value.nationalCode=l),label:"کد ملی",rules:R,onInput:ue},null,8,["modelValue"])]),_:1}),n(c,{cols:"12",md:"4",class:"my-3"},{default:u(()=>[n(A,{modelValue:f.value,"onUpdate:modelValue":[e[8]||(e[8]=l=>f.value=l),se],label:"روز تولد",items:Z.value,variant:"outlined","item-title":"name","item-value":"value",class:"first-select",rules:[l=>!!l||"روز الزامی است"]},null,8,["modelValue","items","rules"])]),_:1}),n(c,{cols:"12",md:"4",class:"my-3"},{default:u(()=>[n(A,{modelValue:V.value,"onUpdate:modelValue":[e[9]||(e[9]=l=>V.value=l),oe],label:"ماه تولد",items:ee.value,variant:"outlined",class:"second-select","item-title":"name","item-value":"value",rules:[l=>!!l||"ماه الزامی است"]},null,8,["modelValue","items","rules"])]),_:1}),n(c,{cols:"12",md:"4",class:"my-3"},{default:u(()=>[n(A,{modelValue:y.value,"onUpdate:modelValue":[e[10]||(e[10]=l=>y.value=l),me],label:"سال تولد",items:ae.value,variant:"outlined",class:"third-select","item-title":"name","item-value":"value",rules:[l=>!!l||"سال الزامی است"]},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),n(q,null,{default:u(()=>[n(K),n(I,{text:"بستن",onClick:e[11]||(e[11]=l=>p.value=!1),size:"large",class:"m-3"}),n(I,{type:"submit",size:"large",class:"m-3",variant:"tonal",text:"ثبت",loading:h.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"]),d.value?(P(),Ve(ye,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:u(()=>[$(r(x.value),1)]),_:1})):be("",!0)]))}},aa=ce(Pe,[["__scopeId","data-v-1d2fbf4e"]]);export{aa as default};
