import{a5 as j,a6 as B,_ as N,r,e as f,w as o,a2 as P,p as E,o as d,b as l,a0 as V,a1 as u,a as i,a4 as c,c as g,aw as F,F as H,a3 as I,B as L,t as A}from"./index-BHyl33af.js";import{V as z}from"./VForm-Da7TyXo-.js";import{V as p}from"./VSelect-DTbrNZ-G.js";import{V as M}from"./VTextField-CQadcvoZ.js";import{V as q}from"./VContainer-CEfELjYy.js";import"./index-BQk_CBw3.js";import"./VImg-BIgGcWVy.js";import"./VMenu-CTuyByyE.js";const w=B(),b=j.create({baseURL:"https://gateway.khaneetala.ir/v1",headers:{"Content-Type":"application/json",Accept:"application/json"}});b.interceptors.request.use(s=>{const n=localStorage.getItem("token");return n?s.headers.Authorization=`Bearer ${n}`:w.replace("/login"),s},s=>Promise.reject(s));b.interceptors.response.use(s=>s,s=>(s.response.status==401&&(localStorage.removeItem("token"),w.replace("/login")),console.error("API Error:",s.response||s.message),Promise.reject(s)));const G={async ReportSubmit(s){const n=JSON.stringify(s);return(await b.post("/report/analyze/data",n)).data}},J={class:"d-flex flex-column justify-start"},O=["href"],$={class:"d-flex justify-end"},K={__name:"TotalReportView",setup(s){const n=r(!1);r(null);const T=r(""),k=r(!1),a=r({report:1,startDate:"",startTime:"",endDate:"",endTime:"",type:"all",deal:"all",status:"all",nationalCode:""}),y=r({link:[]}),x=r([{value:1,label:"واریز و برداشت"},{value:2,label:"معاملات"}]),U=r([{value:"all",label:"همه"},{value:"deposit",label:"واریز"},{value:"withdraw",label:"برداشت"}]),C=r([{value:"all",label:"همه"},{value:"sell",label:"خرید"},{value:"buy",label:"فروش"}]),D=r([{value:"all",label:"همه"},{value:"fromPhone",label:"تلفنی"},{value:"inPerson",label:"حضوری"},{value:"fromGateway",label:"آنلاین"}]),R=r([{value:"all",label:"همه"},{value:"completed",label:"موفق"},{value:"failed",label:"ناموفق"},{value:"pending",label:"در انتظار"}]),S=async()=>{try{n.value=!0;const m=await G.ReportSubmit(a.value);return y.value.link.push(m[1]),m}catch(m){T.value=m.response.data.error||"خطایی رخ داده است!",k.value=!0,setTimeout(()=>{k.value=!1},1e4)}finally{n.value=!1}};return(m,e)=>{const v=E("persian-date-picker");return d(),f(z,{onSubmit:P(S,["prevent"])},{default:o(()=>[l(q,{class:"filter-container"},{default:o(()=>[l(V,null,{default:o(()=>[l(u,{cols:"6",md:"4",class:"my-3"},{default:o(()=>[l(p,{modelValue:a.value.report,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.report=t),items:x.value,label:"نوع گزارش",variant:"outlined",rules:[t=>!!t||"حداقل یک مورد الزامیست"],"item-title":"label","item-value":"value"},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),l(V,null,{default:o(()=>[l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>e[10]||(e[10]=[i("div",{class:"d-flex justify-start align-center"},[i("p",{class:"mb-0"},"زمان شروع: ")],-1)])),_:1}),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(v,{modelValue:a.value.startDate,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.startDate=t),placeholder:"تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(v,{type:"time",modelValue:a.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.startTime=t),placeholder:"زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>e[11]||(e[11]=[i("div",{class:"d-flex justify-start align-center"},[i("p",{class:"mb-0"},"زمان پایان: ")],-1)])),_:1}),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(v,{modelValue:a.value.endDate,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.endDate=t),placeholder:"تاریخ"},null,8,["modelValue"])]),_:1}),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(v,{type:"time",modelValue:a.value.endTime,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.endTime=t),placeholder:"زمان",format:"HH:mm:ss"},null,8,["modelValue"])]),_:1}),a.value.report==1?(d(),f(u,{key:0,cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(p,{modelValue:a.value.type,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.type=t),items:U.value,label:"نوع انتقال",variant:"outlined","item-title":"label","item-value":"value"},null,8,["modelValue","items"])]),_:1})):c("",!0),a.value.report==2?(d(),f(u,{key:1,cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(p,{modelValue:a.value.type,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.type=t),items:C.value,label:"نوع معامله",variant:"outlined","item-title":"label","item-value":"value"},null,8,["modelValue","items"])]),_:1})):c("",!0),a.value.report==2?(d(),f(u,{key:2,cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(p,{modelValue:a.value.deal,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.deal=t),items:D.value,label:"نوع ثبت",variant:"outlined","item-title":"label","item-value":"value"},null,8,["modelValue","items"])]),_:1})):c("",!0),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(p,{modelValue:a.value.status,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.status=t),items:R.value,label:"وضعیت",variant:"outlined","item-title":"label","item-value":"value"},null,8,["modelValue","items"])]),_:1}),l(u,{cols:"6",md:"4",class:"my-4"},{default:o(()=>[l(M,{modelValue:a.value.nationalCode,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.nationalCode=t),label:"کد ملی",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),l(V,null,{default:o(()=>[l(u,{cols:"12"},{default:o(()=>[i("div",J,[y.value.link!=""?(d(!0),g(H,{key:0},F(y.value.link,(t,_)=>(d(),g("a",{class:"download-link my-2",key:_,href:t},"دانلود گزارش "+A(_+1),9,O))),128)):c("",!0)])]),_:1}),l(u,{cols:"12"},{default:o(()=>[i("div",$,[l(I,{type:"submit",loading:n.value},{default:o(()=>e[12]||(e[12]=[L("ایجاد گزارش")])),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1})}}},ae=N(K,[["__scopeId","data-v-16b1e037"]]);export{ae as default};
