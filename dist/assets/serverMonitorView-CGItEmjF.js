import{a5 as w,a6 as h,_ as x,r as n,j as D,c as d,b as e,w as r,F as V,o as m,a0 as A,a1 as I,V as b,a as g,aw as j,a3 as B,t as T}from"./index-BHyl33af.js";import{V as z}from"./VContainer-CEfELjYy.js";import{V as E}from"./VDialog-CevV_aSX.js";import{V as k,b as M}from"./VCard-C66qJ_zi.js";import{V as P}from"./VTextField-CQadcvoZ.js";import{V as U}from"./VDataTable-CDVT_X8O.js";import{a as q}from"./VSelect-DTbrNZ-G.js";import{V as F}from"./VSpacer-CMOsawZu.js";import{e as L}from"./VMenu-CTuyByyE.js";import"./index-BQk_CBw3.js";import"./VImg-BIgGcWVy.js";const _=h(),p=w.create({baseURL:"https://gateway.khaneetala.ir/v1",headers:{"Content-Type":"application/json",Accept:"application/json"}});p.interceptors.request.use(t=>{const o=localStorage.getItem("token");return o?t.headers.Authorization=`Bearer ${o}`:_.replace("/login"),t},t=>Promise.reject(t));p.interceptors.response.use(t=>t,t=>(t.response.status==401&&(localStorage.removeItem("token"),_.replace("/login")),console.error("API Error:",t.response||t.message),Promise.reject(t)));const N={async AllStatus(){return(await p.get("/logger/status")).data}},R={class:"pa-5"},$={__name:"serverMonitorView",setup(t){const o=n(!1),v=n(),y=n([{title:"service name",key:"service"},{title:"status",key:"status"},{title:"request count",key:"total.all"},{title:"request count",key:"total.all"},{title:"success",key:"total.statusCount.success"},{title:"failed",key:"total.statusCount.failed"},{title:"internalIssues",key:"total.statusCount.internalIssues"},{title:"error",key:"error"}]),c=n(null),i=n(),u=n(!1),C=async()=>{try{o.value=!0;const s=await N.AllStatus();return v.value=s.data,s}catch(s){errorMsg.value=s.response.data.error||"خطایی رخ داده است!",alertError.value=!0,setTimeout(()=>{alertError.value=!1},1e4)}finally{o.value=!1}},S=s=>{u.value=!0,i.value=s.total.error,console.log(i.value),console.log(i.value)};return D(()=>{C()}),(s,l)=>(m(),d(V,null,[e(z,null,{default:r(()=>[e(A,null,{default:r(()=>[e(I,{cols:"12"},{default:r(()=>[e(k,{title:"سرویس ها"},{text:r(()=>[e(P,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),label:"جستجو","prepend-inner-icon":"ri-search-line"},null,8,["modelValue"])]),default:r(()=>[e(U,{headers:y.value,items:v.value,search:c.value,loading:o.value},{"item.status":r(({item:a})=>[e(q,{text:a.status==0?"DOWN":"UP",color:a.status==0?"#ff0000":"#43A047",size:"small"},null,8,["text","color"])]),"item.error":r(({item:a})=>[e(b,{class:"me-2",size:"small",icon:"ri-signal-wifi-error-line",color:"#d4af37",onClick:f=>S(a)},null,8,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=a=>u.value=a),"max-width":"500",class:"error-dialog"},{default:r(()=>[e(k,{class:"dialog-card"},{default:r(()=>[g("div",R,[(m(!0),d(V,null,j(i.value,(a,f)=>(m(),d("div",{key:f},[g("p",null,T(a),1),e(L)]))),128))]),e(M,null,{default:r(()=>[e(F),e(B,{text:"close",onClick:l[1]||(l[1]=a=>u.value=!1),size:"large",class:"m-3"})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},te=x($,[["__scopeId","data-v-ac799950"]]);export{te as default};
